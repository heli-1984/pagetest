Made by SkySRN

# Process Explorer and Malware Detection
What is Process Explorer?
Ever wondered which program has a particular file or directory open? Now you can find out. Process Explorer shows you information about which handles and DLLs processes have opened or loaded. The unique capabilities of Process Explorer make it useful for tracking down DLL-version problems or handle leaks and provide insight into the way Windows and applications work.

## Downloading Process Explorer 

[Download Process Explorer](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer)

## Virus Total 
What is Virus Total? 
Virus Total is an online service, handled by Microsoft that analyses suspicious files and URLs to detect types of malwares and malicious content using antivirus engines and website scanners. It provides an API that allows users to access the information generated by Virus Total. You can analyse suspicious files and URLs to detect types of malwares, automatically share them with the security community.
Find more about it here - https://docs.microsoft.com/en-us/connectors/virustotal/

### Creating a Virus Total Account 

[Virus Total Signup](https://www.virustotal.com/gui/sign-in)

Creating a Virus Total account will be helping us in this guide on detecting malware through Process Explorer. This account won't just be used for this purpose, but also would help you all with related purposes. 

### Starting With Process Explorer

Now that you have a Virus Total Account, you will need to open the Process Explorer file/executable. You will be first asked for agreeing to Microsoft's ToS, which you would have to agree if you wish to continue with this guide. After opening PE, you will see a sort of complex UI, which is obvious for beginners. As you scroll down, you would see a whole lot of processes running. These are the processes running in the background, and most of them also aren't viewable on Task Manager. Now, you will see some services which are under a dropdown of certain applications you are using. These are normal, and in fact, are used to make your applications up and running. 

### Enabling the Virus Total Filter 

As you remember, you have created a Virus Total account. Now, we will basically be implementing the Virus Total API in this software, i.e., Process Explorer. 

1. Open Process Explorer and locate "Options" in the upmost left hand corner. 
2. You will see a lot of options to choose from. But we only need Virus Total to be enabled for now. 
3. Click on VirusTotal.com > Check/Enable "VirusTotal.com" and "Submit Unknown Executables".
4. Your Browser would now open with an agreement, which you simply must agree to. This is not in any way stealing any personal or private information.

### Going through the Background Processes 

You will now see a scan being initiated, and hashes being submitted to Virus Total in a separate column. As soon as these hashes are checked by Virus Total, PE will show you the results of the respective process/file. If you see anything having a 1/70(+), detections, simply click on the red text. This will then redirect you to the report made by Virus Total, containing the detections made by Antivirus engines. For most of the cases, a 1/70(+) detection rate is considered as a false positive. But we shouldn't totally depend upon that fact. We will rather judge the file based on other various factors. 

### How to detect/determine a false positive

1. Antivirus Detections
Many a times, you will see that a file, is being detected by such an Antivirus which you haven't ever heard off, or which is not so popular in terms of the security they provide to the customers. Such Antiviruses often display a false positive. 
Common Names of these Antiviruses - 
Jingamin, Cylance, Quttera and some others which you can find, based on the recent reports containing the most false positives shared by these Antiviruses - https://www.virustotal.com/gui/stats
2. Community Score - 
There will be a bar containing a vote presentation given by the community. If the indicator is more towards the green portion, it is likely a false positive, if towards the red portion, it’s not.
You can also navigate to the Community section, which will contain the comments the community has given on the respective file. It may vary if the file is new or hasn't been viewed by anyone else.

### How To Determine a Malicious Process

This might a little tricky and confusing for some people who have just discovered about Virus Total. But for now, these are the steps you should be following –
1.	Rescan the file. Some reports are from previous, old scans. The results of the file can change from time to time, therefore it is important for us to rescan it.

2.	Antivirus Detections: If the file is being detected by a lot of antiviruses, including those which are very well known, it is 100% a malicious file.

3.	Community Score: As you have read above, on how to determine a false positive, this includes the exact same process. If the indicator is more towards the red side, it is a malicious process, which has been identified by various people in the Virus Total community. Also check the community tab. There, users provide with some extra information about the program/file. 


4.	The details tab: Now this area contains a lot of information. The one we will be focusing in this guide will be enough for most of the part. 
You will first of all look at the Signature, which is present under the Signature Info. Make sure, the file has a Valid Signature. 

5.	Relations Tab: This will include information, on what all other sources the given file is contacting to. You will be given the contacted IP addresses. Make sure those are clean. You then would have a graph summary section below. But this is not the only graph we have. In the upright corner, you will see a graph icon, just beside the rescan icon. When you hover over it, it should display this text “Explore in Virus Total Graph”.

6.	As soon as you have opened the graph, you would locate the “Tree Representation”, under Visualization. This will give you a neater presentation. Now, here is when people get confused. You would first, click on the Relations Tab, given in the left-hand side, and there you will have a bunch of results. Click on the following tabs – 

•	Contacted IPs

•	Contacted Domains 

•	Bundled files

If you see any red detection, in any of the files/domains/IPs, received after the display, you will know that it is a malware. What these terms basically mean – 

Contacted IPs – The IP addresses which were contacted, or in other words, connected to, when the file is executed, or this file has relations to. 

Contacted Domains – The domains it contacts or has relations to.

Bundled Files – The files which are not viewable simply by looking at the file. These files are stored/bundled in the respective file being investigated. These can vary from malicious files being bundled in a legit file, or in an actual malicious file to maximize the damage. 


## You have a malicious process running, what are the necessary steps you should take?
We have previously posted a [Writeup On Malware Removal](https://github.com/IWickGames/Technical-Guides/blob/a8c727dfa023331c1fccf4ff7a18bfcf0e807b12/Malware/GENERAL-REMOVAL.MD). You can refer to the same source for this matter.
